{
    "##": "The license will be inside the app directory after installation.",
    "version": "11.00",
    "homepage": "https://www.petges.lu",
    "description": "A Windows Explorer shell extension that allows users to easily change file and folder properties with a right-click.",
    "license": "Freeware",
    "notes": [
        "IMPORTANT FOR NON-ENGLISH SPEAKERS!!!",
        "If you want this application translated to your native langauge, please run the following command:",
        "& \"$dir\\change_language.ps1\"",
        "**The powershell script will propmt you to enter the number that corresponds to your native langauge.**",
        "",
        "1 = BRAZILIAN PORTUGUESE",
        "2 = CZECH",
        "3 = DANISH",
        "4 = FRENCH",
        "5 = GERMAN",
        "6 = HUNGARIAN",
        "7 = ITALIAN",
        "8 = KOREAN",
        "9 = POLISH",
        "10 = SPANISH",
        "11 = SWEDISH",
        "12 = TURKISH",
        "13 = ENGLISH   (ONLY IF YOU NEED TO RESET THE 'messages.ini' FILE BACK TO ENGLISH.)"
    ],
    "url": "https://www.petges.lu/pubfiles/ac-11_00.exe",
    "hash": "md5:2F158D9531FB1E9749C5287EAF533AC0",
    "innosetup": true,
    "architecture": {
        "64bit": {
            "pre_install": [
                "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
                "Remove-Item \"$dir\\acmain,1.exe\", \"$dir\\acshell,1.dll\"; Rename-Item \"$dir\\acmain,2.exe\" 'acmain.exe'",
                "Start-Process 'regsvr32' -ArgumentList @(\"$dir\\acshell,2.dll\", '/s') -Verb 'RunAs' -Wait; Stop-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' -Force",
                "Start-Sleep -Seconds 2"
            ],
            "pre_uninstall": [
                "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
                "Start-Process 'regsvr32' -ArgumentList @('/u', \"$dir\\acshell,2.dll\", '/s') -Verb 'RunAs' -Wait; Stop-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' -Force",
                "Start-Sleep -Seconds 2"
            ]
        },
        "32bit": {
            "pre_install": [
                "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
                "Remove-Item \"$dir\\acmain,2.exe\", \"$dir\\acshell,2.dll\"; Rename-Item \"$dir\\acmain,1.exe\" 'acmain.exe'",
                "Start-Process 'regsvr32' -ArgumentList @(\"$dir\\acshell,1.dll\", '/s') -Verb 'RunAs' -Wait; Stop-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' -Force",
                "Start-Sleep -Seconds 2"
            ],
            "pre_uninstall": [
                "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
                "Start-Process 'regsvr32' -ArgumentList @('/u', \"$dir\\acshell,1.dll\", '/s') -Verb 'RunAs' -Wait; Stop-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' -Force",
                "Start-Sleep -Seconds 2"
            ]
        }
    },
    "post_install": [
        "Copy-Item \"$dir\\template.ini\" \"$dir\\messages,13.ini\"; Copy-Item \"$dir\\template.ini\" \"$dir\\messages.ini\"; Copy-Item \"$dir\\ac,4.pdf\" \"$dir\\ac.pdf\"",
        "Remove-Item \"$dir\\ac,4.pdf\"; Rename-Item \"$dir\\ac,5.pdf\" 'ac,4.pdf'; Rename-Item \"$dir\\ac,6.pdf\" 'ac,5.pdf'; Rename-Item \"$dir\\ac,7.pdf\" 'ac,6.pdf'",
        "Rename-Item \"$dir\\ac,8.pdf\" 'ac,7.pdf'; Rename-Item \"$dir\\ac,9.pdf\" 'ac,8.pdf'; Rename-Item \"$dir\\ac,10.pdf\" 'ac,9.pdf'; Rename-Item \"$dir\\ac,11.pdf\" 'ac,10.pdf';",
        "Rename-Item \"$dir\\ac,12.pdf\" 'ac,11.pdf'; Rename-Item \"$dir\\ac,13.pdf\" 'ac,12.pdf'; Copy-Item \"$dir\\ac.pdf\" \"$dir\\ac,13.pdf\"",
        "New-Item \"$dir\\change_language.ps1\" -Value '$ac_language = Read-Host -Prompt \"Please enter the number that corresponds to your native langauge\"' | Out-Null",
        "Add-Content \"$dir\\change_language.ps1\" -Value @(",
        "'`nCopy-Item \"$dir\\messages,$ac_language.ini\" \"$dir\\messages.ini\" -Force', 'Copy-Item \"$dir\\ac,$ac_language.pdf\" \"$dir\\ac.pdf\" -Force'",
        ")",
        "$content = (Get-Content \"$dir\\change_language.ps1\")",
        "$content = $content.Replace('$dir', \"$dir\")",
        "$content | Set-Content -Path \"$dir\\change_language.ps1\"",
        "$content2 = (Get-Content \"$dir\\change_language.ps1\")",
        "$content2 = $content.Replace('`n', \"`n\")",
        "$content2 | Set-Content -Path \"$dir\\change_language.ps1\"",
        "Start-Sleep -Seconds 2"
    ],
    "bin": "acmain.exe",
    "checkver": {
        "url": "https://www.petges.lu/download/",
        "regex": "ac-([\\d]+)_([\\w]+).exe",
        "replace": "${1}.${2}"
    },
    "autoupdate": {
        "url": "https://www.petges.lu/pubfiles/ac-$underscoreVersion.exe",
        "hash": {
            "url": "https://www.petges.lu/download/",
            "regex": "<p>MD5\\sChecksum:\\s$md5</p>"
        }
    }
}
