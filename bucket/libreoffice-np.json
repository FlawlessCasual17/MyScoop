{
    "version": "24.2.1.1",
    "description": "Powerful and free office suite, a successor to OpenOffice(.org).",
    "homepage": "https://libreoffice.org/",
    "license": "MPL-2.0",
    "suggest": {
        "Visual C++ Redistributable 2015-2022": "extras/vcredist2022"
    },
    "architecture": {
        "64bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.1.1/win/x86_64/LibreOffice_24.2.1.1_Win_x86-64.msi#/setup.msi_",
            "hash": "abf3511413d5e4aa3953906eee2c5001708f10f5bebe507359f21507229457cb",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        },
        "32bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.1.1/win/x86/LibreOffice_24.2.1.1_Win_x86.msi#/setup.msi_",
            "hash": "d9d3fe26ad5072aa552c74805208299c454734c4b4147ce5fa0554b8bd288197",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles(x86)%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        },
        "arm64": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.1.1/win/aarch64/LibreOffice_24.2.1.1_Win_aarch64.msi#/setup.msi_",
            "hash": "c1720882c0421e8c0ce84dd36fa192541548c2a0af11d641191c8f738c4af711",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        }
    },
    "installer": {
        "script": [
            "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
            "Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/i', \"$dir\\setup.msi_\", '/qn', '/norestart')"
        ]
    },
    "bin": [
        "soffice.cmd",
        [
            "soffice.cmd",
            "libreoffice"
        ],
        "unopkg.cmd"
    ],
    "pre_uninstall": [
        "if ($cmd -eq 'uninstall') {",
        "    if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "    Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/x', \"$dir\\setup.msi_\", '/qn', '/norestart')",
        "}"
    ],
    "checkver": {
        "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/latest/win/x86_64/",
        "regex": "LibreOffice_([\\d.]+)_Win_x86-64\\.msi"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86_64/LibreOffice_$version_Win_x86-64.msi#/setup.msi_"
            },
            "32bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86/LibreOffice_$version_Win_x86.msi#/setup.msi_"
            },
            "arm64": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/aarch64/LibreOffice_$version_Win_aarch64.msi#/setup.msi_"
            }
        },
        "hash": {
            "url": "$url.sha256"
        }
    }
}
