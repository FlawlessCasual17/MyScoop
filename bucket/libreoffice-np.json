{
    "version": "24.2.0.3",
    "description": "Powerful and free office suite, a successor to OpenOffice(.org).",
    "homepage": "https://libreoffice.org/",
    "license": "MPL-2.0",
    "suggest": {
        "Visual C++ Redistributable 2015-2022": "extras/vcredist2022"
    },
    "architecture": {
        "64bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.0.3/win/x86_64/LibreOffice_24.2.0.3_Win_x86-64.msi#/setup.msi_",
            "hash": "58dcf13d87ef1279f7229b69949b836b73ce5f039ddb54cdf091f8fea28cc9f2",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        },
        "32bit": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.0.3/win/x86/LibreOffice_24.2.0.3_Win_x86.msi#/setup.msi_",
            "hash": "2d5f64647bb67bbe0393f774c29f83eff65241c4f89719057075097f30ff76ce",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles(x86)%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        },
        "arm64": {
            "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/24.2.0.3/win/aarch64/LibreOffice_24.2.0.3_Win_aarch64.msi#/setup.msi_",
            "hash": "0eb0cfa8183db4003fe361075d707c246ccb1e1d9ea0b5302deabd3df26e27b4",
            "pre_install": [
                "foreach ($z in @('soffice', 'unopkg')) {",
                "    [System.IO.File]::WriteAllLines(\"$dir\\$z.cmd\", \"@`\"%ProgramFiles%\\LibreOffice\\program\\$z.com`\"  %*\", [System.text.UTF8Encoding]($false))",
                "}"
            ]
        }
    },
    "installer": {
        "script": [
            "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
            "Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/i', \"$dir\\setup.msi_\", '/qn', '/norestart')"
        ]
    },
    "bin": [
        "soffice.cmd",
        [
            "soffice.cmd",
            "libreoffice"
        ],
        "unopkg.cmd"
    ],
    "pre_uninstall": [
        "if ($cmd -eq 'uninstall') {",
        "    if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "    Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/x', \"$dir\\setup.msi_\", '/qn', '/norestart')",
        "}"
    ],
    "checkver": {
        "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/latest/win/x86_64/",
        "regex": "LibreOffice_([\\d.]+)_Win_x86-64\\.msi"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86_64/LibreOffice_$version_Win_x86-64.msi#/setup.msi_"
            },
            "32bit": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/x86/LibreOffice_$version_Win_x86.msi#/setup.msi_"
            },
            "arm64": {
                "url": "https://downloadarchive.documentfoundation.org/libreoffice/old/$version/win/aarch64/LibreOffice_$version_Win_aarch64.msi#/setup.msi_"
            }
        },
        "hash": {
            "url": "$url.sha256"
        }
    }
}
