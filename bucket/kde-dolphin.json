{
    "version": "22.12.2-1817",
    "homepage": "https://apps.kde.org/dolphin/",
    "description": "A file manager developed by KDE that lets you navigate and browse the contents of your hard drives, USB sticks, SD cards, and more.",
    "license": "GPL-2.0-or-later",
    "architecture": {
        "64bit": {
            "url": "https://binary-factory.kde.org/job/Dolphin_Release_win64/lastSuccessfulBuild/artifact/dolphin-22.12.2-1817-windows-cl-msvc2019-x86_64.7z",
            "hash": "6d8c559d469b31786bee14953dde33fb8f456c94579fe323d9fdb796231a5111"
        }
    },
    "bin": "bin\\dolphin.exe",
    "shortcuts": [
        [
            "bin\\dolphin.exe",
            "KDE Dolphin"
        ]
    ],
    "notes": [
        "1. 'Move to trash' is not working in the KDE Dolphin for Windows as reported in 'https://www.mail-archive.com/kde-bugs-dist@kde.org/msg677905.html'.",
        "2. If you click the stroage info widget on the right-bottom of the KDE Dolphin for Windows, you don't need to download the software that it will show because it doesn't change something even if you put the software under the system PATH.",
        "3. If you want a somehow smooth experience of the KDE Dolphin for Windows, you can enable 'Delete' in 'Context Menu' under 'Configure Dolphin...'. But YOU SHOULD KNOW the 'Delete' can PERMANENTLY delete files.",
        "4. If you want to get the latest development branch-based installer, please install `kde-dolphin-nightly` from Versions bucket."
    ],
    "pre_uninstall": [
        "Write-Host 'Killing dbus processes.'",
        "Stop-Process -Name 'dbus*' -Force"
    ],
    "post_uninstall": [
        "# Handle registry.",
        "if (Test-Path \"HKCU:\\\\Software\\kde.org\\UserFeedback.org.kde.dolphin\\\") {",
        "   # If it contains only one key, remove it, else remove the key.",
        "   if ((Get-ChildItem \"HKCU:\\\\Software\\kde.org\\\").Count -eq 1) {",
        "       Write-Host \"Removing related registry HKCU:\\\\Software\\kde.org\\\"",
        "       Remove-Item -Recurse \"HKCU:\\\\Software\\kde.org\\\"",
        "   }",
        "   else {",
        "       Write-Host \"Removing related registry HKCU:\\\\Software\\kde.org\\UserFeedback.org.kde.dolphin\\\"",
        "       Remove-Item -Recurse \"HKCU:\\\\Software\\kde.org\\UserFeedback.org.kde.dolphin\\\"",
        "   }",
        "}",
        "# Handle folders.",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\dolphin\\\") {",
        "   Write-Host \"Removing related folder $env:USERPROFILE\\AppData\\Local\\dolphin\\\"",
        "   Remove-Item -Recurse \"$env:USERPROFILE\\AppData\\Local\\dolphin\\\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\session\\dolphin_dolphin_dolphin\") {",
        "   # If it contains only one file, remove it, else remove the key.",
        "   if ((Get-ChildItem \"$env:USERPROFILE\\AppData\\Local\\session\\\").Count -eq 1) {",
        "       Write-Host \"Removing related folder $env:USERPROFILE\\AppData\\Local\\session\\\"",
        "       Remove-Item -Recurse \"$env:USERPROFILE\\AppData\\Local\\session\\\"",
        "   }",
        "   else {",
        "       Write-Host \"Removing related folder $env:USERPROFILE\\AppData\\Local\\session\\dolphin_dolphin_dolphin\"",
        "       Remove-Item \"$env:USERPROFILE\\AppData\\Local\\session\\dolphin_dolphin_dolphin\"",
        "   }",
        "}",
        "# Handle files.",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\") {",
        "   # If the file contains only the dolphin setting:",
        "   # ",
        "   # [Language]",
        "   # dolphin=@ByteArray(...)",
        "   # ",
        "   # then remove the file, else remove the line.",
        "   if ((Get-Content \"$env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\").Count -le 2) {",
        "       Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\"",
        "       Remove-Item \"$env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\"",
        "   }",
        "   else {",
        "       Write-Host \"Changing related file $env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\"",
        "       foreach ($line in Get-Content \"$env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\") {",
        "           if (-not $line.StartsWith('dolphin=')) {",
        "               Write-Output $line > \"$env:USERPROFILE\\AppData\\Local\\__klanguageoverridesrc\"",
        "           }",
        "           else {",
        "               Write-Host \"Removing the line '$line'\"",
        "           }",
        "       }",
        "       Remove-Item \"$env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\"",
        "       Rename-Item \"$env:USERPROFILE\\AppData\\Local\\__klanguageoverridesrc\" \"$env:USERPROFILE\\AppData\\Local\\klanguageoverridesrc\"",
        "   }",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\dolphinrc\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\dolphinrc\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\dolphinrc\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\kdeglobals\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\kdeglobals\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\kdeglobals\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\kiorc\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\kiorc\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\kiorc\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\trashrc\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\trashrc\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\trashrc\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\user-places.xbel\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\user-places.xbel\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\user-places.xbel\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\user-places.xbel.bak\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\user-places.xbel.bak\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\user-places.xbel.bak\"",
        "}",
        "if (Test-Path \"$env:USERPROFILE\\AppData\\Local\\user-places.xbel.tbcache\") {",
        "   Write-Host \"Removing related file $env:USERPROFILE\\AppData\\Local\\user-places.xbel.tbcache\"",
        "   Remove-Item \"$env:USERPROFILE\\AppData\\Local\\user-places.xbel.tbcache\"",
        "}"
    ],
    "checkver": {
        "url": "https://binary-factory.kde.org/job/Dolphin_Release_win64/",
        "regex": "dolphin-([\\d.-]+)-windows-cl-msvc(?<Year>[\\d]+)-x86_64\\.7z"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://binary-factory.kde.org/job/Dolphin_Release_win64/lastSuccessfulBuild/artifact/dolphin-$version-windows-cl-msvc$matchYear-x86_64.7z",
                "hash": {
                    "url": "$url.sha256"
                }
            }
        }
    }
}
