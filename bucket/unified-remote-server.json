{
    "version": "3.13.0.2501",
    "description": "The official server part for the Unified Remote, the remote control for your computer.",
    "homepage": "https://www.unifiedremote.com/",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.unifiedremote.com/terms"
    },
    "notes": [
        "NOTE: Unified Remote requires all of these to be installed so it can work properly.",
        "If you want to add/remove firewall exceptions, run:",
        "$dir\\add_windows_firewall_exceptions.cmd",
        "$dir\\remove_windows_firewall_exceptions.cmd",
        "",
        "If you want to add/remove the Unified Remote server service, run:",
        "$dir\\add_unified_remote_server_service.cmd",
        "$dir\\remove_unified_remote_server_service.cmd",
        "",
        "If you want to add/remove the Unified Virtual HID driver, run:",
        "$dir\\uvhid-Install.bat",
        "$dir\\uvhid-Remove.bat",
        ""
    ],
    "suggest": {
        "vcredist": "extras/vcredist"
    },
    "url": "https://www.unifiedremote.com/static/builds/server/windows-x86/2501/Server-3.13.0.2501.zip",
    "hash": "5fc1af1ddbebae2405b32f6122e6db04a76dcb3971f42560ab3ac339c51f0771",
    "extract_dir": "Server-3.13.0.2501",
    "pre_install": [
        "try {",
        "    # Create '*_windows_firewall_exceptions.cmd' files.",
        "    $value1 = @'",
        "@echo off",
        "fltmc >nul 2>&1 || ( powershell -ex \"unrestricted\" -c \"Start-Process '%0' -Verb 'RunAs'\" & exit 0 )",
        "echo Adding Windows Firewall exceptions...",
        "netsh firewall add allowedprogram \"%~dp0RemoteServerWin.exe\" \"Unified Remote\" ENABLE",
        "netsh advfirewall firewall add rule \"name=Unified Remote\" \"dir=in\" \"action=allow\" \"program=%~dp0RemoteServerWin.exe\"",
        "netsh advfirewall firewall add rule \"name=Unified Remote\" \"dir=out\" \"action=allow\" \"program=\"%~dp0RemoteServerWin.exe\"",
        "echo Done!",
        "pause",
        "'@",
        "    Set-Content \"$dir\\add_windows_firewall_exceptions.cmd\" $value1 -Encoding 'utf8'",
        "    $value2 = @'",
        "@echo off",
        "fltmc >nul 2>&1 || ( powershell -ex \"unrestricted\" -c \"Start-Process '%0' -Verb 'RunAs'\" & exit 0 )",
        "echo Removing Windows Firewall exceptions...",
        "netsh firewall delete allowedprogram \"%~dp0RemoteServerWin.exe\"",
        "netsh advfirewall firewall delete rule \"name=Unified Remote\" \"dir=in\"",
        "netsh advfirewall firewall delete rule \"name=Unified Remote\" \"dir=out\"",
        "echo Done!",
        "pause",
        "'@",
        "    Set-Content \"$dir\\remove_windows_firewall_exceptions.cmd\" $value2 -Encoding 'utf8'",
        "    # Create '*_unified_remote_server_service.cmd' files.",
        "    $value3 = @'",
        "@echo off",
        "fltmc >nul 2>&1 || ( powershell -ex \"unrestricted\" -c \"Start-Process '%0' -Verb 'RunAs'\" & exit 0 )",
        "echo Installing Unified Remote server service...",
        "%~dp0RemoteServerWin.exe /registerService \"/startup=auto\"",
        "net start \"RemoteServerWin\"",
        "echo Done!",
        "pause",
        "'@",
        "    Set-Content \"$dir\\add_unified_remote_server_service.cmd\" $value3 -Encoding 'utf8'",
        "    $value4 = @'",
        "@echo off",
        "fltmc >nul 2>&1 || ( powershell -ex \"unrestricted\" -c \"Start-Process '%0' -Verb 'RunAs'\" & exit 0 )",
        "echo Removing Unified Remote server service...",
        "net stop \"RemoteServerWin\"",
        "%~dp0RemoteServerWin.exe /unregisterService",
        "echo Done!",
        "pause",
        "'@",
        "    Set-Content \"$dir\\remove_unified_remote_server_service.cmd\" $value4 -Encoding 'utf8'",
        "    # Replace the empty line with a command that forces the user to give administrator privileges to the '*.bat' files.",
        "    foreach ($script in (Get-ChildItem \"$dir\\*.bat\")) {",
        "        $cont = ($script | Get-Content) -replace ('^$', 'fltmc >nul 2>&1 || ( powershell -ex \"unrestricted\" -c \"Start-Process ''%0'' -Verb ''RunAs''\" & exit 0 )')",
        "        Set-Content $script $cont -Encoding 'utf8' -Force",
        "    }",
        "    # Create configuration files.",
        "    foreach ($extension in 'log', 'config') { New-Item \"$dir\\Server.$extension\" | Out-Null }",
        "    New-Item \"$dir\\Service.log\" | Out-Null",
        "",
        "} catch {",
        "    Write-Host \"Something is wrong`n$_\"",
        "}"
    ],
    "shortcuts": [
        [
            "RemoteServerWin.exe",
            "Unified Remote"
        ]
    ],
    "persist": [
        "Server.log",
        "Server.config",
        "Service.log"
    ],
    "pre_uninstall": [
        "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "try {",
        "    # Removing Unified Remote releated services, drivers, and firewall modifications.",
        "    Write-Host 'Removing Unified Remote server service...'",
        "    Start-Process 'net' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('stop', 'RemoteServerWin')",
        "    Start-Process \"$dir\\RemoteServerWin.exe\" -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args '/unregisterService'",
        "    Write-Host 'Uninstalling Unified Virtual HID driver...'",
        "    Start-Process \"$dir\\uvhid\\uvhid.exe\" -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args 'remove' -WorkingDirectory \"$dir\\uvhid\"",
        "    Write-Host 'Removing Windows Firewall exceptions...'",
        "    Start-Process 'netsh' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('firewall', 'delete', 'allowedprogram', \"$dir\\RemoteServerWin.exe\")",
        "    Start-Process 'netsh' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('advfirewall', 'firewall', 'delete', 'rule', 'name=Unified Remote', 'dir=out')",
        "    Start-Process 'netsh' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('advfirewall', 'firewall', 'delete', 'rule', 'name=Unified Remote', 'dir=in')",
        "    Write-Host 'Done!'",
        "} catch {",
        "    Write-Host \"Something is wrong`n$_\"",
        "}"
    ],
    "checkver": {
        "script": "(Invoke-WebRequest 'https://www.unifiedremote.com/download/windows-portable').BaseResponse.RequestMessage.RequestUri.AbsoluteUri",
        "regex": "Server-([\\d.]+)\\.zip"
    },
    "autoupdate": {
        "url": "https://www.unifiedremote.com/static/builds/server/windows-x86/$buildVersion/Server-$version.zip",
        "extract_dir": "Server-$version"
    }
}
