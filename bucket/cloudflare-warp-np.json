{
    "version": "2023.7.160.0",
    "homepage": "https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/",
    "description": "An app that allows you to replace the connection between your device and the Internet with a modern, optimized, protocol.",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.cloudflare.com/en-ca/application/terms/"
    },
    "architecture": {
        "64bit": {
            "url": "https://appcenter-filemanagement-distrib4ede6f06e.azureedge.net/bdcc0aaa-796d-41f8-9371-e6c99642b847/Cloudflare_WARP_Release-x64.msi?sv=2019-02-02&sr=c&sig=4L8kBLGajBQSUXg9SX4sg8i5LgeTKi2DpCE%2FXzfWYZM%3D&se=2023-09-07T09%3A33%3A35Z&sp=r#/setup.msi_",
            "hash": "md5:518448cbcd28347ca9190dd59ea31dad"
        }
    },
    "post_install": [
        "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -Args @('/i', \"$dir\\setup.msi_\", '/qn')",
        "Stop-Process -Name 'Cloudflare WARP' -ErrorAction 'SilentlyContinue' -Force; Stop-Service -Name 'CloudflareWARP' -ErrorAction 'SilentlyContinue' -Force"
    ],
    "uninstaller": {
        "script": [
            "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
            "Stop-Process -Name 'Cloudflare WARP' -ErrorAction 'SilentlyContinue' -Force; Stop-Service -Name 'CloudflareWARP' -ErrorAction 'SilentlyContinue' -Force",
            "Start-Process 'msiexec' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -ArgumentList @('/x', \"$dir\\setup.msi_\", '/qn')"
        ]
    },
    "checkver": {
        "script": [
            "$uri_1 = 'https://install.appcenter.ms/api/v0.1/apps/cloudflare/1.1.1.1-windows-1/distribution_groups/release/public_releases?scope=tester&top=10000'",
            "(Invoke-WebRequest $uri_1).Content -match 'id\"\\:(?<ID>[\\d]+).*?version\"\\:\"(?<Version>[\\d.]+)' | Out-Null; $id = $Matches.ID; $version = $Matches.Version",
            "$uri_2 = 'https://install.appcenter.ms/api/v0.1/apps/cloudflare/1.1.1.1-windows-1/distribution_groups/release/releases/$id?is_install_page=true'.Replace('$id', $id)",
            "$jsonCont = Invoke-RestMethod $uri_2; $downloadUri = $jsonCont['version' -eq \"$version\"].download_url; Write-Output \"$downloadUri $id $version\""
        ],
        "regex": "https://appcenter-(?<Uri>filemanagement-[\\w]+\\.azureedge.*)\\s(?<Id>[\\d]+)\\s([\\d.]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://appcenter-$matchUri#/setup.msi_",
                "hash": {
                    "url": "https://install.appcenter.ms/api/v0.1/apps/cloudflare/1.1.1.1-windows-1/distribution_groups/release/releases/$matchId?is_install_page=true",
                    "jsonpath": "$[?(@.version == '$version')].fingerprint"
                }
            }
        }
    }
}
